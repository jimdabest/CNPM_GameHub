<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3205px" preserveAspectRatio="none" style="width:2047px;height:3205px;background:#FFFFFF;" version="1.1" viewBox="0 0 2047 3205" width="2047px" zoomAndPan="magnify"><title>Lu&#7891;ng ch&#7913;c n&#259;ng c&#7911;a Admin - Qu&#7843;n l&#253; ch&#237;nh s&#225;ch t&#237;ch &#273;i&#7875;m - &#273;&#7893;i qu&#224;</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="538.9932" x="750.3489" y="27.9951">Lu&#7891;ng ch&#7913;c n&#259;ng c&#7911;a Admin - Qu&#7843;n l&#253; ch&#237;nh s&#225;ch t&#237;ch &#273;i&#7875;m - &#273;&#7893;i qu&#224;</text><rect fill="none" height="439.7969" style="stroke:#000000;stroke-width:1.5;" width="2020.6909" x="10" y="2670.4063"/><g><title>Admin</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="45.4321" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="49" x2="49" y1="104.5938" y2="3127.2031"/></g><g><title>WebApp</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="427.7192" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="431.3726" x2="431.3726" y1="104.5938" y2="3127.2031"/></g><g><title>Controller</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="686.811" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="690.2246" x2="690.2246" y1="104.5938" y2="3127.2031"/></g><g><title>Service</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="1093.2764" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1096.4058" x2="1096.4058" y1="104.5938" y2="3127.2031"/></g><g><title>Infrastructure</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="1562.8882" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1566.835" x2="1566.835" y1="104.5938" y2="3127.2031"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="3022.6094" width="8" x="1980.2905" y="104.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1983.8901" x2="1983.8901" y1="104.5938" y2="3127.2031"/></g><g class="participant participant-head" data-participant="Admin"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.8643" x="20" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.8643" x="27" y="93.292">Admin</text></g><g class="participant participant-tail" data-participant="Admin"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.8643" x="20" y="3126.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.8643" x="27" y="3146.1982">Admin</text></g><g class="participant participant-head" data-participant="WebApp"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.6934" x="395.3726" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.6934" x="402.3726" y="93.292">WebApp</text></g><g class="participant participant-tail" data-participant="WebApp"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.6934" x="395.3726" y="3126.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.6934" x="402.3726" y="3146.1982">WebApp</text></g><g class="participant participant-head" data-participant="Controller"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.1729" x="649.2246" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.1729" x="656.2246" y="93.292">Controller</text></g><g class="participant participant-tail" data-participant="Controller"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.1729" x="649.2246" y="3126.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.1729" x="656.2246" y="3146.1982">Controller</text></g><g class="participant participant-head" data-participant="Service"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="1064.4058" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="1071.4058" y="93.292">Service</text></g><g class="participant participant-tail" data-participant="Service"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.7412" x="1064.4058" y="3126.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.7412" x="1071.4058" y="3146.1982">Service</text></g><g class="participant participant-head" data-participant="Infrastructure"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.1064" x="1511.835" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1064" x="1518.835" y="93.292">Infrastructure</text></g><g class="participant participant-tail" data-participant="Infrastructure"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.1064" x="1511.835" y="3126.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1064" x="1518.835" y="3146.1982">Infrastructure</text></g><g class="participant participant-head" data-participant="Database"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1947.8901" y="101.292">Database</text><path d="M1966.2905,52.2969 C1966.2905,42.2969 1984.2905,42.2969 1984.2905,42.2969 C1984.2905,42.2969 2002.2905,42.2969 2002.2905,52.2969 L2002.2905,78.2969 C2002.2905,88.2969 1984.2905,88.2969 1984.2905,88.2969 C1984.2905,88.2969 1966.2905,88.2969 1966.2905,78.2969 L1966.2905,52.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1966.2905,52.2969 C1966.2905,62.2969 1984.2905,62.2969 1984.2905,62.2969 C1984.2905,62.2969 2002.2905,62.2969 2002.2905,52.2969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Database"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="1947.8901" y="3139.1982">Database</text><path d="M1966.2905,3152.5 C1966.2905,3142.5 1984.2905,3142.5 1984.2905,3142.5 C1984.2905,3142.5 2002.2905,3142.5 2002.2905,3152.5 L2002.2905,3178.5 C2002.2905,3188.5 1984.2905,3188.5 1984.2905,3188.5 C1984.2905,3188.5 1966.2905,3188.5 1966.2905,3178.5 L1966.2905,3152.5" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1966.2905,3152.5 C1966.2905,3162.5 1984.2905,3162.5 1984.2905,3162.5 C1984.2905,3162.5 2002.2905,3162.5 2002.2905,3152.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="135.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="135.1602" y2="135.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="138.1602" y2="138.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="177.0459" x="931.8225" y="124.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.52" x="937.8225" y="140.6606">Danh s&#225;ch ch&#237;nh s&#225;ch</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,174.8594,429.7192,178.8594,419.7192,182.8594,423.7192,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.1982" x="56.4321" y="173.7935">M&#7903; trang "Reward Policies"</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,203.9922,688.811,207.9922,678.811,211.9922,682.811,207.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="207.9922" y2="207.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3091" x="438.7192" y="202.9263">GET /reward-policies/</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,233.125,1095.2764,237.125,1085.2764,241.125,1089.2764,237.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="237.125" y2="237.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.7349" x="697.811" y="232.0591">list_reward_policies()</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,262.2578,1564.8882,266.2578,1554.8882,270.2578,1558.8882,266.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="266.2578" y2="266.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.1997" x="1104.2764" y="261.1919">reward_policy_repository.list()</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,291.3906,1982.2905,295.3906,1972.2905,299.3906,1976.2905,295.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="295.3906" y2="295.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.7939" x="1573.8882" y="290.3247">SELECT * FROM reward_policies</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,320.5234,1567.8882,324.5234,1577.8882,328.5234,1573.8882,324.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="324.5234" y2="324.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.7036" x="1583.8882" y="319.4575">rows</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,349.6563,1098.2764,353.6563,1108.2764,357.6563,1104.2764,353.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="353.6563" y2="353.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.9517" x="1114.2764" y="348.5903">List[RewardPolicy]</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,378.7891,691.811,382.7891,701.811,386.7891,697.811,382.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="382.7891" y2="382.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.9517" x="707.811" y="377.7231">List[RewardPolicy]</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,407.9219,432.7192,411.9219,442.7192,415.9219,438.7192,411.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="411.9219" y2="411.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.0132" x="448.7192" y="406.856">200 + JSON</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Admin"><polygon fill="#181818" points="60.4321,437.0547,50.4321,441.0547,60.4321,445.0547,56.4321,441.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="54.4321" x2="430.7192" y1="441.0547" y2="441.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.7925" x="66.4321" y="435.9888">Hi&#7875;n th&#7883; danh s&#225;ch</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="469.6211"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="469.6211" y2="469.6211"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="472.6211" y2="472.6211"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="107.082" x="966.8044" y="459.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88.5562" x="972.8044" y="475.1216">Xem chi ti&#7871;t</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,509.3203,429.7192,513.3203,419.7192,517.3203,423.7192,513.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="513.3203" y2="513.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.3452" x="56.4321" y="508.2544">Xem chi ti&#7871;t policy {policy_id}</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,538.4531,688.811,542.4531,678.811,546.4531,682.811,542.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="542.4531" y2="542.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.4849" x="438.7192" y="537.3872">GET /reward-policies/{policy_id}</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,567.5859,1095.2764,571.5859,1085.2764,575.5859,1089.2764,571.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="571.5859" y2="571.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9326" x="697.811" y="566.52">get_reward_policy(policy_id)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,596.7188,1564.8882,600.7188,1554.8882,604.7188,1558.8882,600.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="600.7188" y2="600.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.896" x="1104.2764" y="595.6528">reward_policy_repository.get_by_id(policy_id)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,625.8516,1982.2905,629.8516,1972.2905,633.8516,1976.2905,629.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="629.8516" y2="629.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.8047" x="1573.8882" y="624.7856">SELECT * FROM reward_policies WHERE id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,654.9844,1567.8882,658.9844,1577.8882,662.9844,1573.8882,658.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="658.9844" y2="658.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.5654" x="1583.8882" y="653.9185">policy|None</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,684.1172,1098.2764,688.1172,1108.2764,692.1172,1104.2764,688.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="688.1172" y2="688.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.5654" x="1114.2764" y="683.0513">policy|None</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,713.25,691.811,717.25,701.811,721.25,697.811,717.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="717.25" y2="717.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.5654" x="707.811" y="712.1841">policy|None</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,742.3828,432.7192,746.3828,442.7192,750.3828,438.7192,746.3828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="746.3828" y2="746.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.2607" x="448.7192" y="741.3169">200 (policy) | 404 (Not found)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="774.9492"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="774.9492" y2="774.9492"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="777.9492" y2="777.9492"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="124.4111" x="958.1399" y="764.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8853" x="964.1399" y="780.4497">T&#7841;o m&#7899;i policy</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,814.6484,429.7192,818.6484,419.7192,822.6484,423.7192,818.6484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="818.6484" y2="818.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.2632" x="56.4321" y="813.5825">T&#7841;o policy</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,843.7813,688.811,847.7813,678.811,851.7813,682.811,847.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="847.7813" y2="847.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3452" x="438.7192" y="842.7153">POST /reward-policies/</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,872.9141,1095.2764,876.9141,1085.2764,880.9141,1089.2764,876.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="876.9141" y2="876.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.4741" x="697.811" y="871.8481">create_reward_policy(name, rules, status, ...)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,902.0469,1564.8882,906.0469,1554.8882,910.0469,1558.8882,906.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="906.0469" y2="906.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.8462" x="1104.2764" y="900.981">reward_policy_repository.add(policy)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,931.1797,1982.2905,935.1797,1972.2905,939.1797,1976.2905,935.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="935.1797" y2="935.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.665" x="1573.8882" y="930.1138">INSERT INTO reward_policies (...)</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,960.3125,1567.8882,964.3125,1577.8882,968.3125,1573.8882,964.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="964.3125" y2="964.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.2334" x="1583.8882" y="959.2466">new_id</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,989.4453,1098.2764,993.4453,1108.2764,997.4453,1104.2764,993.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="993.4453" y2="993.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.0835" x="1114.2764" y="988.3794">RewardPolicy</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,1018.5781,691.811,1022.5781,701.811,1026.5781,697.811,1022.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="1022.5781" y2="1022.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.0835" x="707.811" y="1017.5122">RewardPolicy</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,1047.7109,432.7192,1051.7109,442.7192,1055.7109,438.7192,1051.7109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="1051.7109" y2="1051.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8789" x="448.7192" y="1046.645">201 Created + JSON</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="1080.2773"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1080.2773" y2="1080.2773"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1083.2773" y2="1083.2773"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="132.022" x="954.3345" y="1069.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113.4961" x="960.3345" y="1085.7778">C&#7853;p nh&#7853;t policy</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,1119.9766,429.7192,1123.9766,419.7192,1127.9766,423.7192,1123.9766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="1123.9766" y2="1123.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.6802" x="56.4321" y="1118.9106">C&#7853;p nh&#7853;t policy {policy_id}</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,1149.1094,688.811,1153.1094,678.811,1157.1094,682.811,1153.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="1153.1094" y2="1153.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.5518" x="438.7192" y="1148.0435">PUT /reward-policies/{policy_id}</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,1178.2422,1095.2764,1182.2422,1085.2764,1186.2422,1089.2764,1182.2422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="1182.2422" y2="1182.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="363.6255" x="697.811" y="1177.1763">update_reward_policy(policy_id, name, rules, status, ...)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,1207.375,1564.8882,1211.375,1554.8882,1215.375,1558.8882,1211.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="1211.375" y2="1211.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261.1807" x="1104.2764" y="1206.3091">reward_policy_repository.update(policy)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,1236.5078,1982.2905,1240.5078,1972.2905,1244.5078,1976.2905,1240.5078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="1240.5078" y2="1240.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.6216" x="1573.8882" y="1235.4419">UPDATE reward_policies SET ... WHERE id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,1265.6406,1567.8882,1269.6406,1577.8882,1273.6406,1573.8882,1269.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="1269.6406" y2="1269.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.3057" x="1583.8882" y="1264.5747">OK|Not found</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,1294.7734,1098.2764,1298.7734,1108.2764,1302.7734,1104.2764,1298.7734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="1298.7734" y2="1298.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.3789" x="1114.2764" y="1293.7075">RewardPolicy|None</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,1323.9063,691.811,1327.9063,701.811,1331.9063,697.811,1327.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="1327.9063" y2="1327.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.3789" x="707.811" y="1322.8403">RewardPolicy|None</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,1353.0391,432.7192,1357.0391,442.7192,1361.0391,438.7192,1357.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="1357.0391" y2="1357.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.4609" x="448.7192" y="1351.9731">200 OK | 404 Not found</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="1385.6055"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1385.6055" y2="1385.6055"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1388.6055" y2="1388.6055"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="94.1074" x="973.2917" y="1375.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75.5815" x="979.2917" y="1391.106">X&#243;a policy</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,1425.3047,429.7192,1429.3047,419.7192,1433.3047,423.7192,1429.3047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="1429.3047" y2="1429.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.5361" x="56.4321" y="1424.2388">X&#243;a policy {policy_id}</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,1454.4375,688.811,1458.4375,678.811,1462.4375,682.811,1458.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="1458.4375" y2="1458.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.0918" x="438.7192" y="1453.3716">DELETE /reward-policies/{policy_id}</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,1483.5703,1095.2764,1487.5703,1085.2764,1491.5703,1089.2764,1487.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="1487.5703" y2="1487.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.5405" x="697.811" y="1482.5044">delete_reward_policy(policy_id)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,1512.7031,1564.8882,1516.7031,1554.8882,1520.7031,1558.8882,1516.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="1516.7031" y2="1516.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.6948" x="1104.2764" y="1511.6372">reward_policy_repository.delete(policy_id)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,1541.8359,1982.2905,1545.8359,1972.2905,1549.8359,1976.2905,1545.8359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="1545.8359" y2="1545.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.0674" x="1573.8882" y="1540.77">DELETE FROM reward_policies WHERE id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,1570.9688,1567.8882,1574.9688,1577.8882,1578.9688,1573.8882,1574.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="1574.9688" y2="1574.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.3057" x="1583.8882" y="1569.9028">OK|Not found</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,1600.1016,1098.2764,1604.1016,1108.2764,1608.1016,1104.2764,1604.1016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="1604.1016" y2="1604.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.2813" x="1114.2764" y="1599.0356">None|error</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,1629.2344,691.811,1633.2344,701.811,1637.2344,697.811,1633.2344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="1633.2344" y2="1633.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.2813" x="707.811" y="1628.1685">None|error</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,1658.3672,432.7192,1662.3672,442.7192,1666.3672,438.7192,1662.3672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="1662.3672" y2="1662.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2158" x="448.7192" y="1657.3013">204 No Content | 404 Not found</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="1690.9336"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1690.9336" y2="1690.9336"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="1693.9336" y2="1693.9336"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="230.417" x="905.137" y="1680.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="211.8911" x="911.137" y="1696.4341">&#193;p d&#7909;ng policy &#273;&#7875; c&#7897;ng &#273;i&#7875;m</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,1730.6328,429.7192,1734.6328,419.7192,1738.6328,423.7192,1734.6328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="1734.6328" y2="1734.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.2871" x="56.4321" y="1729.5669">Ch&#7885;n "&#193;p d&#7909;ng policy" (user_id, policy_id, action_code)</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,1759.7656,688.811,1763.7656,678.811,1767.7656,682.811,1763.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="1763.7656" y2="1763.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2104" x="438.7192" y="1758.6997">POST /point-transactions/</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,1788.8984,1095.2764,1792.8984,1085.2764,1796.8984,1089.2764,1792.8984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="1792.8984" y2="1792.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.4653" x="697.811" y="1787.8325">apply_reward_policy(user_id, policy_id, action_code, meta)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,1818.0313,1564.8882,1822.0313,1554.8882,1826.0313,1558.8882,1822.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="1822.0313" y2="1822.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.896" x="1104.2764" y="1816.9653">reward_policy_repository.get_by_id(policy_id)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,1847.1641,1982.2905,1851.1641,1972.2905,1855.1641,1976.2905,1851.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="1851.1641" y2="1851.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.8047" x="1573.8882" y="1846.0981">SELECT * FROM reward_policies WHERE id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,1876.2969,1567.8882,1880.2969,1577.8882,1884.2969,1573.8882,1880.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="1880.2969" y2="1880.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.27" x="1583.8882" y="1875.231">policy</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,1905.4297,1098.2764,1909.4297,1108.2764,1913.4297,1104.2764,1909.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="1909.4297" y2="1909.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.27" x="1114.2764" y="1904.3638">policy</text></g><g class="message" data-participant-1="Service" data-participant-2="Service"><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1139.2764" y1="1958.3516" y2="1958.3516"/><line style="stroke:#181818;stroke-width:1;" x1="1139.2764" x2="1139.2764" y1="1958.3516" y2="1971.3516"/><line style="stroke:#181818;stroke-width:1;" x1="1098.2764" x2="1139.2764" y1="1971.3516" y2="1971.3516"/><polygon fill="#181818" points="1108.2764,1967.3516,1098.2764,1971.3516,1108.2764,1975.3516,1104.2764,1971.3516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.7471" x="1104.2764" y="1933.4966">calculate_points(policy, action_code, meta)</text><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="171.5854" x="1104.2764" y="1952.3423">&gt; points_awarded</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,1996.4844,1564.8882,2000.4844,1554.8882,2004.4844,1558.8882,2000.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2000.4844" y2="2000.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445.6118" x="1104.2764" y="1995.4185">point_transaction_repository.add(user_id, +points_awarded, reason)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2025.6172,1982.2905,2029.6172,1972.2905,2033.6172,1976.2905,2029.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2029.6172" y2="2029.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.5303" x="1573.8882" y="2024.5513">INSERT INTO point_transactions (...)</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2054.75,1567.8882,2058.75,1577.8882,2062.75,1573.8882,2058.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2058.75" y2="2058.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1583.8882" y="2053.6841">OK</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2083.8828,1098.2764,2087.8828,1108.2764,2091.8828,1104.2764,2087.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2087.8828" y2="2087.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1114.2764" y="2082.8169">OK</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,2113.0156,1564.8882,2117.0156,1554.8882,2121.0156,1558.8882,2117.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2117.0156" y2="2117.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.7407" x="1104.2764" y="2111.9497">user_points_repository.increment(user_id, points_awarded)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2142.1484,1982.2905,2146.1484,1972.2905,2150.1484,1976.2905,2146.1484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2146.1484" y2="2146.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393.4023" x="1573.8882" y="2141.0825">UPDATE user_points SET points=points+? WHERE user_id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2171.2813,1567.8882,2175.2813,1577.8882,2179.2813,1573.8882,2175.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2175.2813" y2="2175.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1583.8882" y="2170.2153">OK</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2200.4141,1098.2764,2204.4141,1108.2764,2208.4141,1104.2764,2204.4141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2204.4141" y2="2204.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1114.2764" y="2199.3481">OK</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,2229.5469,691.811,2233.5469,701.811,2237.5469,697.811,2233.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="2233.5469" y2="2233.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.731" x="707.811" y="2228.481">201 Created (transaction + new balance)</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,2258.6797,432.7192,2262.6797,442.7192,2266.6797,438.7192,2262.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="2262.6797" y2="2262.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.0132" x="448.7192" y="2257.6138">201 + JSON</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Admin"><polygon fill="#181818" points="60.4321,2287.8125,50.4321,2291.8125,60.4321,2295.8125,56.4321,2291.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="54.4321" x2="430.7192" y1="2291.8125" y2="2291.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.438" x="66.4321" y="2286.7466">Hi&#7875;n th&#7883; &#273;i&#7875;m &#273;&#227; c&#7897;ng</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2040.6909" x="0" y="2320.3789"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="2320.3789" y2="2320.3789"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2040.6909" y1="2323.3789" y2="2323.3789"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="74.6646" x="983.0132" y="2309.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56.1387" x="989.0132" y="2325.8794">&#272;&#7893;i qu&#224;</text><g class="message" data-participant-1="Admin" data-participant-2="WebApp"><polygon fill="#181818" points="419.7192,2360.0781,429.7192,2364.0781,419.7192,2368.0781,423.7192,2364.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="49.4321" x2="425.7192" y1="2364.0781" y2="2364.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.9907" x="56.4321" y="2359.0122">Ch&#7885;n "&#272;&#7893;i qu&#224;" (user_id, reward_id)</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Controller"><polygon fill="#181818" points="678.811,2389.2109,688.811,2393.2109,678.811,2397.2109,682.811,2393.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="431.7192" x2="684.811" y1="2393.2109" y2="2393.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3398" x="438.7192" y="2388.145">POST /redemptions/</text></g><g class="message" data-participant-1="Controller" data-participant-2="Service"><polygon fill="#181818" points="1085.2764,2418.3438,1095.2764,2422.3438,1085.2764,2426.3438,1089.2764,2422.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="690.811" x2="1091.2764" y1="2422.3438" y2="2422.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.3213" x="697.811" y="2417.2778">redeem_reward(user_id, reward_id)</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,2447.4766,1564.8882,2451.4766,1554.8882,2455.4766,1558.8882,2451.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2451.4766" y2="2451.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312.8887" x="1104.2764" y="2446.4106">reward_catalog_repository.get_by_id(reward_id)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2476.6094,1982.2905,2480.6094,1972.2905,2484.6094,1976.2905,2480.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2480.6094" y2="2480.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1182" x="1573.8882" y="2475.5435">SELECT * FROM rewards WHERE id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2505.7422,1567.8882,2509.7422,1577.8882,2513.7422,1573.8882,2509.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2509.7422" y2="2509.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.5054" x="1583.8882" y="2504.6763">reward(cost_points, stock, ...)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2534.875,1098.2764,2538.875,1108.2764,2542.875,1104.2764,2538.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2538.875" y2="2538.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.5381" x="1114.2764" y="2533.8091">reward</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,2564.0078,1564.8882,2568.0078,1554.8882,2572.0078,1558.8882,2568.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2568.0078" y2="2568.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.3267" x="1104.2764" y="2562.9419">user_points_repository.get_balance(user_id)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2593.1406,1982.2905,2597.1406,1972.2905,2601.1406,1976.2905,2597.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2597.1406" y2="2597.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.8706" x="1573.8882" y="2592.0747">SELECT points FROM user_points WHERE user_id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2622.2734,1567.8882,2626.2734,1577.8882,2630.2734,1573.8882,2626.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2626.2734" y2="2626.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8374" x="1583.8882" y="2621.2075">current_points</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2651.4063,1098.2764,2655.4063,1108.2764,2659.4063,1104.2764,2655.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2655.4063" y2="2655.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8374" x="1114.2764" y="2650.3403">current_points</text></g><path d="M10,2670.4063 L74.4429,2670.4063 L74.4429,2677.5391 L64.4429,2687.5391 L10,2687.5391 L10,2670.4063" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="439.7969" style="stroke:#000000;stroke-width:1.5;" width="2020.6909" x="10" y="2670.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="2683.4731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140.4487" x="89.4429" y="2682.6167">[&#272;&#7911; &#273;i&#7875;m v&#224; c&#242;n h&#224;ng]</text><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,2704.6719,1564.8882,2708.6719,1554.8882,2712.6719,1558.8882,2708.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2708.6719" y2="2708.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410.3696" x="1104.2764" y="2703.606">user_points_repository.decrement(user_id, reward.cost_points)</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2733.8047,1982.2905,2737.8047,1972.2905,2741.8047,1976.2905,2737.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2737.8047" y2="2737.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.2007" x="1573.8882" y="2732.7388">UPDATE user_points SET points=points-? WHERE user_id=?</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2762.9375,1567.8882,2766.9375,1577.8882,2770.9375,1573.8882,2766.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2766.9375" y2="2766.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1583.8882" y="2761.8716">OK</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2792.0703,1098.2764,2796.0703,1108.2764,2800.0703,1104.2764,2796.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2796.0703" y2="2796.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1114.2764" y="2791.0044">OK</text></g><g class="message" data-participant-1="Service" data-participant-2="Infrastructure"><polygon fill="#181818" points="1554.8882,2821.2031,1564.8882,2825.2031,1554.8882,2829.2031,1558.8882,2825.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1097.2764" x2="1560.8882" y1="2825.2031" y2="2825.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.5259" x="1104.2764" y="2820.1372">redemption_repository.add(user_id, reward_id, status='approved')</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Database"><polygon fill="#181818" points="1972.2905,2850.3359,1982.2905,2854.3359,1972.2905,2858.3359,1976.2905,2854.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1566.8882" x2="1978.2905" y1="2854.3359" y2="2854.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.7183" x="1573.8882" y="2849.27">INSERT INTO redemptions(...)</text></g><g class="message" data-participant-1="Database" data-participant-2="Infrastructure"><polygon fill="#181818" points="1577.8882,2879.4688,1567.8882,2883.4688,1577.8882,2887.4688,1573.8882,2883.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1571.8882" x2="1983.2905" y1="2883.4688" y2="2883.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="1583.8882" y="2878.4028">OK</text></g><g class="message" data-participant-1="Infrastructure" data-participant-2="Service"><polygon fill="#181818" points="1108.2764,2908.6016,1098.2764,2912.6016,1108.2764,2916.6016,1104.2764,2912.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1102.2764" x2="1565.8882" y1="2912.6016" y2="2912.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.4102" x="1114.2764" y="2907.5356">redemption</text></g><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,2937.7344,691.811,2941.7344,701.811,2945.7344,697.811,2941.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="2941.7344" y2="2941.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.7051" x="707.811" y="2936.6685">201 Created (redemption + new balance)</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,2966.8672,432.7192,2970.8672,442.7192,2974.8672,438.7192,2970.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="2970.8672" y2="2970.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.0132" x="448.7192" y="2965.8013">201 + JSON</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Admin"><polygon fill="#181818" points="60.4321,2996,50.4321,3000,60.4321,3004,56.4321,3000" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="54.4321" x2="430.7192" y1="3000" y2="3000"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.6636" x="66.4321" y="2994.9341">Hi&#7875;n th&#7883; "&#272;&#7893;i qu&#224; th&#224;nh c&#244;ng"</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="2030.6909" y1="3009" y2="3009"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171.1768" x="15" y="3019.2104">[Thi&#7871;u &#273;i&#7875;m ho&#7863;c h&#7871;t h&#224;ng]</text><g class="message" data-participant-1="Service" data-participant-2="Controller"><polygon fill="#181818" points="701.811,3039.9375,691.811,3043.9375,701.811,3047.9375,697.811,3043.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="695.811" x2="1096.2764" y1="3043.9375" y2="3043.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.1553" x="707.811" y="3038.8716">400 Bad Request (reason)</text></g><g class="message" data-participant-1="Controller" data-participant-2="WebApp"><polygon fill="#181818" points="442.7192,3069.0703,432.7192,3073.0703,442.7192,3077.0703,438.7192,3073.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="436.7192" x2="689.811" y1="3073.0703" y2="3073.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.3252" x="448.7192" y="3068.0044">400 + {"error": "..."}</text></g><g class="message" data-participant-1="WebApp" data-participant-2="Admin"><polygon fill="#181818" points="60.4321,3098.2031,50.4321,3102.2031,60.4321,3106.2031,56.4321,3102.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="54.4321" x2="430.7192" y1="3102.2031" y2="3102.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.2388" x="66.4321" y="3097.1372">Th&#244;ng b&#225;o l&#7895;i</text></g><!--SRC=[rLZFR-D45BxxhtZAfGdziTsbfqZPLKb3KzectIRL8W6gN7ksiN36NdlSgjgkHEaHhKG52112R5dG2aGlW8GK2t5m_n7_9xon7MSSnuwJSg67EXb_ysRU-zxxvasOndG2EuxlVa6FGUdvxYyAqDjB_iLttyYmhlOr2ilmsF47hodetj-8ycve3splMka1ysxm_-sLvhkNVSJTNldkLneySxnNacJA5jCKpPGf2mqbHfwGetNJJ0pL3SeiGzU9bHZk4Ej4KqXYR8i-jMIRMOx278j8gipa8zaci15zaAI5MiQVj03tA_3um1_ys88TxtkeDxsNhIPql8jwCsTQhORMOyyJOS2tKQGUHdvLOTTtVm1coHZBqZuvbIqLzWmTzq_iaXI2E7paSnKs6rsuPmNOPJF2tfD628wFWb45NRFPOGW-78BB5Ibwpw7965L119_XLDEmDMPOPolS54vDuhc5OJIhq6diDEfTU0lUtM_lmjYoqX07ovEMDKxjb6tHanrS_eCmH464pZuQUJ4MeGbGCJn2-1-ihi8YlDTfj-9Wuzk0fIeqURvIO9Zmdu4QaofnZjydVIHN0wRvWt_OH6h78650uNaKM4rzCGk_uhGCgez9akcpSZndFiAvmIC-NJGqD_tmfDdORu2crXxbPqAus7dBe2Gt8KHSLYQ8c9mKY1oim3cihQv1kMKmU6eu5FtbP7VzmRK1VT_zJXlIE8dm41O2ChZTQtTcA5x58Z8ZOwHIkK-Mm79qOY-1pMJcu7DbPMK-ZcLro6u-jLkjJcE_YuzkEqLiELWzbrDAJZ5xSkaKwpMJpmGeaz3xK0yYfmvhcvDOzmSt9j0UFbWUYvDmqujsxs2-edLCDKrnF6q9_bksmzKA4Nwmjx7URQIuxg0uuVA5YxczVHuNKs7wysiwZSofxFPsLDEZNGJoxVqXvoM1-7uw-HkeUnYhUVXNYKwo-P-FvT1cKT6EDdydoIxCCgVhd5YMOMNIAq0oUULq1fC8DdafVZERiqbDteCAU1TxiE6xFxKs4qqUbEk- -mqEtdw-vRkVxi81Ic1b5kkOQDw52Qhl_epzNPHElFczv8tpjpWsx8ad2X7s7Iyfb58cIb1sR685-Y18XQmmpQ27Yg6IIkxnOneQPSkywRJ3ETada6oQ-jbOTavPUmdwXCd_muwZGBCXEZKwfMLTSNIkua5WxMZlauBo8QqzX11rAFEz4ZKlJW7oK21g_EIEgLXC6iKJWyYsGOkVwQcb2XthxUtSeE7h7E-2pKVx5lpIABOzVIniCT54vmgTMuBnuCmAFzR2n-AZA3MY5QRBMs4tnmfEx4NAGdInCS6M28vaNQOAbcjEArFiUZ8KajihxtKaBaM440NmxGeAdEz-kOMNNUyJA7VtVVVNMFCMOREv1QscF_YjLKJxkEPnSz7rFbVO19meQL4LyzBFRw9LqZVpvOjZI3_IhuahJ5Sf1JD3DuudovHWQLQPAYvFqVOL0w_oOGBpLj1GFeuwmRpS3ETASzHXu6IOdyF85N8oAhh0Kx4APweunR4ib81eRgw7Or19rbcGWM_YcZZ1F5Iytodql5TO5W2p1qCbAL4A8xiYi591qtULfkMqD05C4wVqicFobE_pg98opvSupuUNaDe2jWQMSKBKXMbk9w-EST66nyjTdHiPJ3YP9yEZAUCg331TXm6cAB4eQpY4ATV3xFkJ7fSaegERtHx_FSY9ixDd-8E_5EW5FnAbCdJCaJMyqhmZgtW7UkOGct5dmdC-S-jhmIzSpqj1HrsgGWd3NdenqOrkZsyJZhnh0tJV_LgJ25N_1G00]--></g></svg>